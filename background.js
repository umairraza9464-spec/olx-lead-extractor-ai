chrome.runtime.onMessage.addListener((request,sender,sendResponse)=>{if(request.action==='sendToSheets'){sendToGoogleSheets(request.data).then(response=>sendResponse(response)).catch(error=>sendResponse({success:false,error:error.message}));return true}});async function sendToGoogleSheets(data){try{const config=await chrome.storage.sync.get(['webhookUrl']);if(!config.webhookUrl){throw new Error('Webhook URL not configured')}const response=await fetch(config.webhookUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});if(!response.ok){throw new Error('Failed to send to Google Sheets')}return{success:true,message:'Data sent to Google Sheets'}}catch(error){console.error('Error sending to sheets:',error);return{success:false,error:error.message}}}
